<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Asylum Input</title>
    <script>
        function generateFields() {
            const story = "In the dead of night, a [noun] [verb] quietly through the [adjective] halls of the abandoned asylum. The air was thick with [noun], and the only sound was the distant [verb] of chains. Emily [verb] cautiously, her flashlight casting long shadows that seemed to [verb] on their own. She felt a [adjective] chill as she [verb] a door that led to the basement. The stairs creaked under her weight, and with each step, the [noun] grew louder. Suddenly, a [adjective] scream echoed through the darkness, and Emily knew she wasn't alone. Something [verb] just beyond the edge of her light, its [noun] glinting menacingly. She turned to [verb], but the door slammed shut, trapping her in the [adjective] depths of the asylum, where the [noun] of the past still [verb] the halls.";
            const parts = story.match(/\[(noun|verb|adjective)\]/g);
            const counts = { noun: 0, verb: 0, adjective: 0 };

            parts.forEach(part => {
                counts[part.slice(1, -1)]++;
            });

            const fieldContainer = document.getElementById('fields');
            Object.keys(counts).forEach(part => {
                for (let i = 0; i < counts[part]; i++) {
                    const div = document.createElement('div');
                    div.innerHTML = `<input type='text' name='${part}' placeholder='Enter ${part} #${i + 1}' />`;
                    fieldContainer.appendChild(div);
                }
            });
        }

        function handleSubmit(event) {
            event.preventDefault();
            const inputs = document.querySelectorAll('input[type="text"]');
            const words = Array.from(inputs).reduce((acc, input) => {
                if (!acc[input.name]) acc[input.name] = [];
                acc[input.name].push(input.value);
                return acc;
            }, {});
            localStorage.setItem('words', JSON.stringify(words));
            window.location.href = 'asylum-story.html';
        }
    </script>
</head>
<body onload="generateFields()">
    <form onsubmit="handleSubmit(event)">
        <div id="fields"></div>
        <button type="submit">Done</button>
    </form>
</body>
</html>